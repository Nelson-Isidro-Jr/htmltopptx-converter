<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML to PPTX Converter - Free Online HTML to PowerPoint Tool</title>
  <meta name="description" content="Free online tool to convert HTML and CSS into PowerPoint presentations. Create professional PPTX slides from your web content instantly. No sign-up required. A powerful alternative for AI presentation generation.">
  <meta name="keywords" content="html to pptx, html to powerpoint, convert html to pptx, online presentation maker, free pptx converter, web to powerpoint, AI presentation tool, genspark alternative, genspark ai, html slides, pptx generator, presentation converter, html presentation, css to powerpoint">
  <meta name="robots" content="index, follow">
  <meta name="author" content="HTML to PPTX Converter">
  <link rel="canonical" href="https://htmltopptx-converter.onrender.com/">

  <!-- Favicon - SVG Icon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300ff88'/%3E%3Cstop offset='100%25' style='stop-color:%2300aaff'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='%230a0e14'/%3E%3Crect x='10' y='10' width='80' height='80' rx='15' fill='url(%23grad)' opacity='0.1'/%3E%3Ctext x='50' y='38' font-family='Arial,sans-serif' font-size='24' font-weight='bold' fill='url(%23grad)' text-anchor='middle'%3EHTML%3C/text%3E%3Cpath d='M25 50 L45 50 L45 55 L35 55 L35 75 L25 75 Z' fill='%2300ff88'/%3E%3Cpath d='M55 50 L75 50 L75 75 L55 75 Z M60 55 L60 70 L70 70 L70 55 Z' fill='%2300aaff'/%3E%3Cpath d='M30 58 L40 58 L40 72 L30 72 Z' fill='%230a0e14' opacity='0.3'/%3E%3C/svg%3E">
  <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300ff88'/%3E%3Cstop offset='100%25' style='stop-color:%2300aaff'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='%230a0e14'/%3E%3Crect x='10' y='10' width='80' height='80' rx='15' fill='url(%23grad)' opacity='0.1'/%3E%3Ctext x='50' y='38' font-family='Arial,sans-serif' font-size='24' font-weight='bold' fill='url(%23grad)' text-anchor='middle'%3EHTML%3C/text%3E%3Cpath d='M25 50 L45 50 L45 55 L35 55 L35 75 L25 75 Z' fill='%2300ff88'/%3E%3Cpath d='M55 50 L75 50 L75 75 L55 75 Z M60 55 L60 70 L70 70 L70 55 Z' fill='%2300aaff'/%3E%3Cpath d='M30 58 L40 58 L40 72 L30 72 Z' fill='%230a0e14' opacity='0.3'/%3E%3C/svg%3E">

  <!-- Open Graph -->
  <meta property="og:title" content="HTML to PPTX Converter - Free Online Tool">
  <meta property="og:description" content="Convert HTML and CSS into professional PowerPoint presentations instantly. Free, no sign-up, ad-free experience.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://htmltopptx-converter.onrender.com/">
  <meta property="og:site_name" content="HTML to PPTX Converter">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="HTML to PPTX Converter - Free Online Tool">
  <meta name="twitter:description" content="Convert HTML and CSS into professional PowerPoint presentations instantly. Free, no sign-up required.">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "HTML to PPTX Converter",
    "url": "https://htmltopptx-converter.onrender.com/",
    "description": "Free online tool to convert HTML and CSS into PowerPoint presentations. Create professional PPTX slides from your web content instantly. A powerful alternative to AI presentation tools like Genspark.",
    "applicationCategory": "Productivity",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Convert HTML/CSS to PPTX",
      "High-quality slide rendering",
      "Custom slide dimensions",
      "Fade transitions",
      "Live preview",
      "Drag and drop slide reordering",
      "Multiple presentation support",
      "No sign-up required"
    ]
  }
  </script>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-dark: #0a0e14;
      --bg-card: #14181f;
      --bg-hover: #1c2128;
      --accent: #00ff88;
      --accent-dim: #00cc6a;
      --text: #e6edf3;
      --text-dim: #8b949e;
      --border: #30363d;
    }

    body {
      font-family: 'Space Mono', monospace;
      background: var(--bg-dark);
      color: var(--text);
      overflow-x: hidden;
    }

    /* Animated grid background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 49px, var(--border) 49px, var(--border) 50px),
        repeating-linear-gradient(90deg, transparent, transparent 49px, var(--border) 49px, var(--border) 50px);
      opacity: 0.3;
      animation: gridScroll 20s linear infinite;
      z-index: 0;
      pointer-events: none;
    }

    @keyframes gridScroll {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }

    .app {
      position: relative;
      z-index: 1;
      max-width: 1600px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      padding: 40px 0;
      position: relative;
    }

    .header h1 {
      font-family: 'Syne', sans-serif;
      font-size: 72px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--accent) 0%, #00aaff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -2px;
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .header p {
      color: var(--text-dim);
      font-size: 14px;
      letter-spacing: 2px;
    }

    .main-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 900px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent), #00aaff);
    }

    .card-title {
      font-family: 'Syne', sans-serif;
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .card-title span {
      color: var(--accent);
    }

    textarea {
      width: 100%;
      min-height: 200px;
      background: var(--bg-dark);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-family: 'Space Mono', monospace;
      font-size: 13px;
      padding: 16px;
      resize: vertical;
      outline: none;
      transition: border 0.2s;
    }

    textarea:focus {
      border-color: var(--accent);
    }

    .btn {
      background: var(--accent);
      color: var(--bg-dark);
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-family: 'Space Mono', monospace;
      font-weight: 700;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn:hover {
      background: var(--accent-dim);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 255, 136, 0.3);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .btn-secondary:hover {
      background: var(--bg-hover);
      border-color: var(--accent);
      box-shadow: none;
    }

    .btn-small {
      padding: 8px 14px;
      font-size: 11px;
    }

    .input-section {
      margin-bottom: 16px;
    }

    .input-label {
      font-size: 12px;
      color: var(--text-dim);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .input-actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .slides-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
      margin-top: 20px;
      max-height: 500px;
      overflow-y: auto;
      padding: 8px;
    }

    .slide-card {
      background: var(--bg-dark);
      border: 2px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      cursor: grab;
      transition: all 0.2s;
      position: relative;
    }

    .slide-card:hover {
      border-color: var(--accent);
      transform: scale(1.02);
    }

    .slide-card.dragging {
      opacity: 0.5;
      cursor: grabbing;
    }

    .slide-preview {
      width: 100%;
      aspect-ratio: 16/9;
      background: #000;
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .slide-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .slide-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
    }

    .slide-number {
      font-size: 12px;
      color: var(--text-dim);
    }

    .slide-dimensions {
      font-size: 10px;
      color: var(--text-dim);
      font-family: 'Space Mono', monospace;
    }

    .slide-actions {
      display: flex;
      gap: 8px;
    }

    .icon-btn {
      background: transparent;
      border: 1px solid var(--border);
      width: 32px;
      height: 32px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-dim);
      transition: all 0.2s;
    }

    .icon-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: var(--bg-hover);
    }

    .icon-btn.delete:hover {
      border-color: #ff4444;
      color: #ff4444;
    }

    .preview-panel {
      background: #000;
      border-radius: 12px;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .preview-panel img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .preview-iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: white;
      border-radius: 4px;
    }

    .preview-nav {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 16px;
      align-items: center;
    }

    .preview-counter {
      color: var(--text-dim);
      font-size: 14px;
      min-width: 80px;
      text-align: center;
    }

    .export-section {
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
    }

    .export-section input {
      flex: 1;
      min-width: 200px;
      background: var(--bg-dark);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 16px;
      color: var(--text);
      font-family: 'Space Mono', monospace;
      font-size: 14px;
      outline: none;
    }

    .export-section input:focus {
      border-color: var(--accent);
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
    }

    .checkbox-label input {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-dim);
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .loading {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10, 14, 20, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(8px);
    }

    .loading-content {
      text-align: center;
    }

    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--bg-card);
      border: 1px solid var(--accent);
      border-radius: 8px;
      padding: 16px 24px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      z-index: 2000;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .section-divider {
      border: none;
      border-top: 1px solid var(--border);
      margin: 20px 0;
    }

    .dimensions-row {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 12px;
    }

    .dimensions-row input {
      width: 80px;
      background: var(--bg-dark);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 8px;
      color: var(--text);
      font-family: 'Space Mono';
    }

    .code-preview-container {
      background: var(--bg-dark);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
      max-height: 300px;
      overflow: auto;
    }

    .code-preview-content {
      font-family: 'Space Mono', monospace;
      font-size: 12px;
      color: var(--text);
      white-space: pre-wrap;
      word-wrap: break-word;
      line-height: 1.5;
    }

    .full-width {
      grid-column: 1 / -1;
    }

    /* Buy Me a Coffee Popup */
    .coffee-popup {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      max-width: 300px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      z-index: 1500;
      animation: slideInLeft 0.5s ease;
    }

    @keyframes slideInLeft {
      from { transform: translateX(-400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .coffee-popup-close {
      position: absolute;
      top: 8px;
      right: 8px;
      background: transparent;
      border: none;
      color: var(--text-dim);
      font-size: 18px;
      cursor: pointer;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s;
    }

    .coffee-popup-close:hover {
      background: var(--bg-hover);
      color: var(--text);
    }

    .coffee-heart {
      display: inline-block;
      font-size: 24px;
      animation: heartPulse 1.2s ease-in-out infinite;
    }

    @keyframes heartPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    .coffee-popup p {
      color: var(--text-dim);
      font-size: 13px;
      line-height: 1.5;
      margin: 8px 0 14px;
    }

    .coffee-btn {
      display: inline-block;
      background: #ffdd00;
      color: #000;
      border: none;
      padding: 10px 18px;
      border-radius: 8px;
      font-family: 'Space Mono', monospace;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.2s;
      text-transform: none;
    }

    .coffee-btn:hover {
      background: #e6c800;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 221, 0, 0.4);
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const API_URL = '/api';

    function CoffeePopup() {
      const [visible, setVisible] = useState(true);

      const dismiss = () => {
        setVisible(false);
      };

      if (!visible) return null;

      return (
        <div className="coffee-popup">
          <button className="coffee-popup-close" onClick={dismiss}>√ó</button>
          <div className="coffee-heart">‚ù§Ô∏è</div>
          <p>Love the ad-free experience? Buy me a coffee to keep it that way!</p>
          <a
            className="coffee-btn"
            href="https://buymeacoffee.com/isidronelsw"
            target="_blank"
            rel="noopener noreferrer"
          >
            ‚òï Buy me a coffee
          </a>
        </div>
      );
    }

    function App() {
      const [presentationId, setPresentationId] = useState(null);
      const [slides, setSlides] = useState([]);
      
      // Second presentation state
      const [presentationId2, setPresentationId2] = useState(null);
      const [slides2, setSlides2] = useState([]);
      
      // Separate states for normal and translated content
      const [htmlInput, setHtmlInput] = useState('');
      
      const [currentSlide, setCurrentSlide] = useState(0);
      const [currentSlide2, setCurrentSlide2] = useState(0);
      const [filename, setFilename] = useState('presentation');
      const [addTransition, setAddTransition] = useState(true);
      const [slideWidth, setSlideWidth] = useState(1280);
      const [slideHeight, setSlideHeight] = useState(720);
      const [loading, setLoading] = useState(false);
      const [loadingText, setLoadingText] = useState('');
      const [toast, setToast] = useState(null);
      
      // Toggle between Slide 1 and Slide 2
      const [targetSlide, setTargetSlide] = useState(1); // 1 for Slide 1, 2 for Slide 2
      
      // Preview state - shows what will be added to slide (editable)
      const [previewCode, setPreviewCode] = useState('');
      
      const previewIframeRef = useRef(null);

      useEffect(() => {
        createPresentation();
        createPresentation2();
      }, []);

      // Update real-time preview when htmlInput changes
      useEffect(() => {
        setPreviewCode(htmlInput);
      }, [htmlInput]);

      // Update iframe when previewCode changes
      useEffect(() => {
        if (previewIframeRef.current && previewCode) {
          const iframe = previewIframeRef.current;
          const blob = new Blob([previewCode], { type: 'text/html' });
          const blobUrl = URL.createObjectURL(blob);
          iframe.src = blobUrl;
          
          return () => {
            URL.revokeObjectURL(blobUrl);
          };
        }
      }, [previewCode]);

      const createPresentation = async () => {
        try {
          const res = await fetch(`${API_URL}/presentations`, { method: 'POST' });
          const data = await res.json();
          setPresentationId(data.id);
        } catch (error) {
          showToast('‚ùå Failed to create presentation');
        }
      };

      const createPresentation2 = async () => {
        try {
          const res = await fetch(`${API_URL}/presentations`, { method: 'POST' });
          const data = await res.json();
          setPresentationId2(data.id);
        } catch (error) {
          showToast('‚ùå Failed to create presentation 2');
        }
      };

      const addSlide = async () => {
        const contentToAdd = previewCode || htmlInput;
        
        if (!contentToAdd.trim()) {
          showToast('Please enter HTML code');
          return;
        }

        setLoading(true);
        setLoadingText('Rendering slide...');

        try {
          // Determine which presentation to add to based on targetSlide
          const targetPresentationId = targetSlide === 1 ? presentationId : presentationId2;
          const targetSlides = targetSlide === 1 ? slides : slides2;
          const setTargetSlides = targetSlide === 1 ? setSlides : setSlides2;
          
          const res = await fetch(`${API_URL}/presentations/${targetPresentationId}/slides`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              html: contentToAdd,
              width: slideWidth,
              height: slideHeight
            })
          });

          const data = await res.json();
          setTargetSlides([...targetSlides, {
            id: data.id,
            preview: data.preview,
            width: data.width,
            height: data.height
          }]);
          
          // Clear inputs after adding
          setHtmlInput('');
          setPreviewCode('');
          showToast(`‚úÖ Slide added to Presentation ${targetSlide}!`);
        } catch (error) {
          showToast('‚ùå Error adding slide');
        } finally {
          setLoading(false);
        }
      };

      // Normal copy/paste functions
      const copyHtml = () => {
        navigator.clipboard.writeText(htmlInput);
        showToast('üìã HTML copied to clipboard!');
      };

      const pasteHtml = async () => {
        try {
          const text = await navigator.clipboard.readText();
          setHtmlInput(text);
          showToast('üìã Pasted from clipboard!');
        } catch (err) {
          showToast('‚ùå Could not access clipboard');
        }
      };

      // Use original instead of translation
      const useOriginal = () => {
        setPreviewCode(htmlInput);
        showToast('‚úÖ Using original version');
      };

      const deleteSlide = async (slideId) => {
        try {
          await fetch(`${API_URL}/presentations/${presentationId}/slides/${slideId}`, {
            method: 'DELETE'
          });

          const newSlides = slides.filter(s => s.id !== slideId);
          setSlides(newSlides);
          
          if (currentSlide >= newSlides.length) {
            setCurrentSlide(Math.max(0, newSlides.length - 1));
          }

          showToast('üóëÔ∏è Slide deleted from Presentation 1');
        } catch (error) {
          showToast('‚ùå Error deleting slide');
        }
      };

      const deleteSlide2 = async (slideId) => {
        try {
          await fetch(`${API_URL}/presentations/${presentationId2}/slides/${slideId}`, {
            method: 'DELETE'
          });

          const newSlides = slides2.filter(s => s.id !== slideId);
          setSlides2(newSlides);
          
          if (currentSlide2 >= newSlides.length) {
            setCurrentSlide2(Math.max(0, newSlides.length - 1));
          }

          showToast('üóëÔ∏è Slide deleted from Presentation 2');
        } catch (error) {
          showToast('‚ùå Error deleting slide');
        }
      };

      const reorderSlides = (fromIndex, toIndex) => {
        const newSlides = [...slides];
        const [removed] = newSlides.splice(fromIndex, 1);
        newSlides.splice(toIndex, 0, removed);
        setSlides(newSlides);

        const slideIds = newSlides.map(s => s.id);
        fetch(`${API_URL}/presentations/${presentationId}/slides/reorder`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ slideIds })
        });
      };

      const reorderSlides2 = (fromIndex, toIndex) => {
        const newSlides = [...slides2];
        const [removed] = newSlides.splice(fromIndex, 1);
        newSlides.splice(toIndex, 0, removed);
        setSlides2(newSlides);

        const slideIds = newSlides.map(s => s.id);
        fetch(`${API_URL}/presentations/${presentationId2}/slides/reorder`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ slideIds })
        });
      };

      const exportPPTX = async () => {
        if (slides.length === 0 && slides2.length === 0) {
          showToast('Add slides first!');
          return;
        }

        setLoading(true);
        setLoadingText('Exporting presentations...');

        try {
          // Export both presentations as separate files
          const res = await fetch(`${API_URL}/export-both`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
              filename,
              presentationId,
              presentationId2
            })
          });

          const data = await res.json();
          
          // Helper function to download base64 data
          const downloadBase64 = (base64Data, filename) => {
            const binaryString = atob(base64Data);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) {
              bytes[i] = binaryString.charCodeAt(i);
            }
            const blob = new Blob([bytes], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
          };
          
          // Download Presentation 1
          if (data.pptx1 && slides.length > 0) {
            downloadBase64(data.pptx1, data.filename1);
          }
          
          // Download Presentation 2
          if (data.pptx2 && slides2.length > 0) {
            downloadBase64(data.pptx2, data.filename2);
          }

          showToast(`‚úÖ Presentations downloaded!`);
        } catch (error) {
          showToast('‚ùå Export failed');
        } finally {
          setLoading(false);
        }
      };

      const showToast = (message) => {
        setToast(message);
        setTimeout(() => setToast(null), 3000);
      };

      return (
        <div className="app">
          <div className="header">
            <h1>HTML ‚Üí PPTX</h1>
            <p>BUILD ‚Ä¢ PREVIEW ‚Ä¢ EXPORT</p>
          </div>

          {/* Two Column Layout for Input, Text Extraction, and Preview */}
          <div className="main-grid" style={{ marginBottom: '20px', gridTemplateColumns: '1fr' }}>
            {/* Normal HTML Input (Editable) */}
            <div className="card">
              <div className="card-title">
                <span>‚úèÔ∏è</span> Normal HTML Input (Editable)
              </div>
              
              <div className="input-label">
                <span>üìù</span> Paste or type your HTML/CSS code:
              </div>
              
              <textarea
                value={htmlInput}
                onChange={(e) => setHtmlInput(e.target.value)}
                placeholder="<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body { font-family: Arial; }\n  </style>\n</head>\n<body>\n  <h1>Your Content Here</h1>\n</body>\n</html>"
                style={{ minHeight: '300px' }}
              />
              
              <div className="input-actions">
                <button className="btn btn-secondary btn-small" onClick={copyHtml}>
                  üìã Copy
                </button>
                <button className="btn btn-secondary btn-small" onClick={pasteHtml}>
                  üì• Paste
                </button>
                <button className="btn btn-small" onClick={() => { setHtmlInput(''); setPreviewCode(''); }}>
                  üóëÔ∏è Clear
                </button>
              </div>
              
              <div className="input-label" style={{ marginTop: '16px' }}>
                <span>üí°</span> Changes here update the preview in real-time
              </div>
            </div>

            {/* Editable Code Preview - Below HTML Input */}
            <div className="card">
              <div className="card-title">
                <span>üëÅÔ∏è</span> Editable Code Preview
              </div>
              
              <div className="input-label">
                <span>üîç</span> Edit code before adding to slide:
              </div>
              
              <textarea
                value={previewCode}
                onChange={(e) => setPreviewCode(e.target.value)}
                placeholder="Code preview will appear here. You can edit it before adding to slide..."
                style={{ 
                  minHeight: '200px',
                  backgroundColor: '#1c2128',
                  border: '2px solid var(--accent)',
                  fontSize: '12px'
                }}
              />
              
              <div className="input-actions" style={{ marginBottom: '16px' }}>
                <button className="btn btn-secondary btn-small" onClick={useOriginal}>
                  ‚Ü©Ô∏è Use Original
                </button>
                <button 
                  className="btn btn-secondary btn-small" 
                  onClick={() => { setPreviewCode(''); }}
                >
                  üóëÔ∏è Clear Preview
                </button>
              </div>

              <hr className="section-divider" />

              <div className="card-title">
                <span>üñºÔ∏è</span> Visual Preview (Exact Slide Size: {slideWidth}√ó{slideHeight}):
              </div>
              
              <div className="preview-panel" style={{ 
                height: `${Math.min(slideHeight, 600)}px`,
                width: '100%',
                maxWidth: `${slideWidth}px`,
                margin: '0 auto'
              }}>
                  {previewCode ? (
                    <iframe
                      ref={previewIframeRef}
                      className="preview-iframe"
                      title="Preview"
                      style={{ 
                        width: '100%',
                        height: '100%',
                        border: 'none'
                      }}
                    />
                  ) : (
                    <div style={{ textAlign: 'center', color: 'var(--text-dim)' }}>
                      <div style={{ fontSize: '48px', marginBottom: '12px', opacity: 0.3 }}>üñºÔ∏è</div>
                      <div>Enter HTML to see preview</div>
                    </div>
                  )}
                </div>

              <div className="dimensions-row">
                <span style={{ color: 'var(--text-dim)', fontSize: '12px' }}>Size:</span>
                <input
                  type="number"
                  value={slideWidth}
                  onChange={(e) => setSlideWidth(parseInt(e.target.value) || 1280)}
                  placeholder="1280"
                />
                <span style={{ color: 'var(--text-dim)' }}>√ó</span>
                <input
                  type="number"
                  value={slideHeight}
                  onChange={(e) => setSlideHeight(parseInt(e.target.value) || 720)}
                  placeholder="720"
                />
                <label className="checkbox-label" style={{ marginLeft: 'auto' }}>
                  <input
                    type="checkbox"
                    checked={addTransition}
                    onChange={(e) => setAddTransition(e.target.checked)}
                  />
                  <span style={{ fontSize: '12px' }}>üé® Fade</span>
                </label>
              </div>

              <button 
                className="btn" 
                onClick={addSlide}
                style={{ width: '100%', marginTop: '16px' }}
                disabled={!previewCode.trim()}
              >
                ‚ûï ADD TO SLIDE {targetSlide}
              </button>
              
              <div style={{ marginTop: '12px', display: 'flex', justifyContent: 'center', alignItems: 'center', gap: '12px' }}>
                <label className="checkbox-label" style={{ fontSize: '14px', cursor: 'pointer' }}>
                  <input
                    type="checkbox"
                    checked={targetSlide === 2}
                    onChange={(e) => setTargetSlide(e.target.checked ? 2 : 1)}
                    style={{ width: '20px', height: '20px', cursor: 'pointer' }}
                  />
                  <span style={{ marginLeft: '8px' }}>Add to Slide 2</span>
                </label>
              </div>
            </div>
          </div>

          {/* Slides Section - Presentation 1 */}
          <div className="card" style={{ marginBottom: '20px' }}>
            <div className="card-title">
              <span>‚ñ¶</span> Presentation 1 - Slides ({slides.length})
            </div>
            {slides.length === 0 ? (
              <div className="empty-state">
                <div className="empty-state-icon">‚ñ¶</div>
                <div>Add your first slide to Presentation 1 using the HTML input above</div>
              </div>
            ) : (
              <div className="slides-container">
                {slides.map((slide, index) => (
                  <div
                    key={slide.id}
                    className="slide-card"
                    draggable
                    onDragStart={(e) => {
                      e.dataTransfer.effectAllowed = 'move';
                      e.dataTransfer.setData('text/plain', index);
                      e.currentTarget.classList.add('dragging');
                    }}
                    onDragEnd={(e) => {
                      e.currentTarget.classList.remove('dragging');
                    }}
                    onDragOver={(e) => {
                      e.preventDefault();
                      e.dataTransfer.dropEffect = 'move';
                    }}
                    onDrop={(e) => {
                      e.preventDefault();
                      const fromIndex = parseInt(e.dataTransfer.getData('text/plain'));
                      reorderSlides(fromIndex, index);
                    }}
                    onClick={() => setCurrentSlide(index)}
                    style={{ borderColor: currentSlide === index ? 'var(--accent)' : undefined }}
                  >
                    <div className="slide-preview">
                      <img src={slide.preview} alt={`Slide ${index + 1}`} />
                    </div>
                    <div className="slide-info">
                      <div className="slide-number">Slide {index + 1}</div>
                      {slide.width && slide.height && (
                        <div className="slide-dimensions">
                          {slide.width} √ó {slide.height}
                        </div>
                      )}
                      <div className="slide-actions">
                        <button
                          className="icon-btn delete"
                          onClick={(e) => {
                            e.stopPropagation();
                            deleteSlide(slide.id);
                          }}
                        >
                          √ó
                        </button>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>

          {/* Slides Section - Presentation 2 */}
          <div className="card" style={{ marginBottom: '20px' }}>
            <div className="card-title">
              <span>‚ñ¶</span> Presentation 2 - Slides ({slides2.length})
            </div>
            {slides2.length === 0 ? (
              <div className="empty-state">
                <div className="empty-state-icon">‚ñ¶</div>
                <div>Add your first slide to Presentation 2 by checking "Add to Slide 2" checkbox</div>
              </div>
            ) : (
              <div className="slides-container">
                {slides2.map((slide, index) => (
                  <div
                    key={slide.id}
                    className="slide-card"
                    draggable
                    onDragStart={(e) => {
                      e.dataTransfer.effectAllowed = 'move';
                      e.dataTransfer.setData('text/plain', index);
                      e.currentTarget.classList.add('dragging');
                    }}
                    onDragEnd={(e) => {
                      e.currentTarget.classList.remove('dragging');
                    }}
                    onDragOver={(e) => {
                      e.preventDefault();
                      e.dataTransfer.dropEffect = 'move';
                    }}
                    onDrop={(e) => {
                      e.preventDefault();
                      const fromIndex = parseInt(e.dataTransfer.getData('text/plain'));
                      reorderSlides2(fromIndex, index);
                    }}
                    onClick={() => setCurrentSlide2(index)}
                    style={{ borderColor: currentSlide2 === index ? 'var(--accent)' : undefined }}
                  >
                    <div className="slide-preview">
                      <img src={slide.preview} alt={`Slide ${index + 1}`} />
                    </div>
                    <div className="slide-info">
                      <div className="slide-number">Slide {index + 1}</div>
                      {slide.width && slide.height && (
                        <div className="slide-dimensions">
                          {slide.width} √ó {slide.height}
                        </div>
                      )}
                      <div className="slide-actions">
                        <button
                          className="icon-btn delete"
                          onClick={(e) => {
                            e.stopPropagation();
                            deleteSlide2(slide.id);
                          }}
                        >
                          √ó
                        </button>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>

          {/* Export Section */}
          <div className="card">
            <div className="card-title">
              <span>‚Üì</span> Export Both Presentations
            </div>
            <div className="export-section">
              <input
                type="text"
                value={filename}
                onChange={(e) => setFilename(e.target.value)}
                placeholder="presentation"
              />
              <button className="btn" onClick={exportPPTX}>
                ‚Üì DOWNLOAD BOTH PPTX
              </button>
            </div>
            <div style={{ marginTop: '12px', color: 'var(--text-dim)', fontSize: '12px' }}>
              Downloads 2 separate PPTX files: {filename}_1.pptx and {filename}_2.pptx
            </div>
          </div>

          {/* Loading Overlay */}
          {loading && (
            <div className="loading">
              <div className="loading-content">
                <div className="spinner"></div>
                <div>{loadingText}</div>
              </div>
            </div>
          )}

          {/* Toast Notification */}
          {toast && <div className="toast">{toast}</div>}

          <CoffeePopup />
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
